!function(r){var e={create:"POST",update:"PUT","delete":"DELETE",read:"GET"},t=function(r){return r&&r.url?_.isFunction(r.url)?r.url():r.url:null},n=function(){throw new Error("A 'url' property or function must be specified")};Backbone.sync=function(o,a,c){var u=e[o],i=_.extend({type:u,dataType:"json",beforeSend:function(e){if(!c.noCSRF){var t=r('meta[name="csrf-token"]').attr("content");t&&e.setRequestHeader("X-CSRF-Token",t)}a.trigger("sync:start")}},c);if(i.url||(i.url=t(a)||n()),!i.data&&a&&("create"==o||"update"==o)){i.contentType="application/json";var s={};a.paramRoot?s[a.paramRoot]=a.toJSON():s=a.toJSON(),i.data=JSON.stringify(s)}"GET"!==i.type&&(i.processData=!1);var p=c.complete;i.complete=function(r,e){a.trigger("sync:end"),p&&p(r,e)};var f=c.success;i.success=function(r){f&&f(a,r,c),a.trigger("sync",a,r,c)};var l=c.error;return i.error=function(r){l&&l(a,r,c),a.trigger("error",a,r,c)},r.ajax(i)}}(jQuery);