!function(e){function t(e){var t,a=e.originalEvent.changedTouches,i=a[0],r="";switch(e.type){case"touchmove":r="mousemove";break;case"touchend":r="mouseup";break;default:return}t=document.createEvent("MouseEvent"),t.initMouseEvent(r,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(t),e.preventDefault()}e.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}},e.fn.rateit=function(a,i){var r,n=1,s={},l="init",d=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};if(0==this.length)return this;if(r=e.type(a),"object"==r||void 0===a||null==a)s=e.extend({},e.fn.rateit.defaults,a);else{if("string"==r&&void 0===i)return this.data("rateit"+d(a));"string"==r&&(l="setvalue")}return this.each(function(){var r,h,o,u,c,m,v,g,f=e(this),p=function(e,t){if(null!=t){var a="aria-value"+("value"==e?"now":e),i=f.find(".rateit-range");void 0!=i.attr(a)&&i.attr(a,t)}return arguments[0]="rateit"+d(e),f.data.apply(f,arguments)};if(f.hasClass("rateit")||f.addClass("rateit"),r="rtl"!=f.css("direction"),"setvalue"==l){if(!p("init"))throw"Can't set value before init";"readonly"!=a||1!=i||p("readonly")||(f.find(".rateit-range").unbind(),p("wired",!1)),"value"==a&&(i=null==i?p("min"):Math.max(p("min"),Math.min(p("max"),i))),p("backingfld")&&(h=e(p("backingfld")),"value"==a&&h.val(i),"min"==a&&h[0].min&&(h[0].min=i),"max"==a&&h[0].max&&(h[0].max=i),"step"==a&&h[0].step&&(h[0].step=i)),p(a,i)}p("init")||(p("min",p("min")||s.min),p("max",p("max")||s.max),p("step",p("step")||s.step),p("readonly",void 0!==p("readonly")?p("readonly"):s.readonly),p("resetable",void 0!==p("resetable")?p("resetable"):s.resetable),p("backingfld",p("backingfld")||s.backingfld),p("starwidth",p("starwidth")||s.starwidth),p("starheight",p("starheight")||s.starheight),p("value",Math.max(p("min"),Math.min(p("max"),p("value")||s.value||s.min))),p("ispreset",void 0!==p("ispreset")?p("ispreset"):s.ispreset),p("backingfld")&&(h=e(p("backingfld")),p("value",h.hide().val()),(h.attr("disabled")||h.attr("readonly"))&&p("readonly",!0),"INPUT"==h[0].nodeName&&("range"==h[0].type||"text"==h[0].type)&&(p("min",parseInt(h.attr("min"))||p("min")),p("max",parseInt(h.attr("max"))||p("max")),p("step",parseInt(h.attr("step"))||p("step"))),"SELECT"==h[0].nodeName&&h[0].options.length>1&&(p("min",Number(h[0].options[0].value)),p("max",Number(h[0].options[h[0].length-1].value)),p("step",Number(h[0].options[1].value)-Number(h[0].options[0].value)))),o="DIV"==f[0].nodeName?"div":"span",console.log(f[0].nodeName),n++,u='<button id="rateit-reset-{{index}}" class="rateit-reset" aria-label="'+e.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+e.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+p("min")+'" aria-valuemax="'+p("max")+'" aria-valuenow="'+p("value")+'"><{{element}} class="rateit-selected" style="height:'+p("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+p("starheight")+'px"></{{element}}></{{element}}>',f.append(u.replace(/{{index}}/gi,n).replace(/{{element}}/gi,o)),r||(f.find(".rateit-reset").css("float","right"),f.find(".rateit-selected").addClass("rateit-selected-rtl"),f.find(".rateit-hover").addClass("rateit-hover-rtl")),p("init",!0)),c=f.find(".rateit-range"),c.width(p("starwidth")*(p("max")-p("min"))).height(p("starheight")),m="rateit-preset"+(r?"":"-rtl"),p("ispreset")?f.find(".rateit-selected").addClass(m):f.find(".rateit-selected").removeClass(m),null!=p("value")&&(v=(p("value")-p("min"))*p("starwidth"),f.find(".rateit-selected").width(v)),g=f.find(".rateit-reset"),g.data("wired")!==!0&&g.bind("click",function(t){t.preventDefault(),g.blur(),p("value",p("min")),c.find(".rateit-hover").hide().width(0),c.find(".rateit-selected").width(0).show(),p("backingfld")&&e(p("backingfld")).val(p("min")),f.trigger("reset")}).data("wired",!0);var w=function(t,a){var i=a.changedTouches?a.changedTouches[0].pageX:a.pageX,n=i-e(t).offset().left;return r||(n=c.width()-n),n>c.width()&&(n=c.width()),0>n&&(n=0),v=Math.ceil(n/p("starwidth")*(1/p("step")))},b=function(e){var t,a=e*p("starwidth")*p("step"),i=c.find(".rateit-hover");i.data("width")!=a&&(c.find(".rateit-selected").hide(),i.width(a).show().data("width",a),t=[e*p("step")+p("min")],f.trigger("hover",t).trigger("over",t))},x=function(t){p("value",t),p("backingfld")&&e(p("backingfld")).val(t),p("ispreset")&&(c.find(".rateit-selected").removeClass(m),p("ispreset",!1)),c.find(".rateit-hover").hide(),c.find(".rateit-selected").width(t*p("starwidth")-p("min")*p("starwidth")).show(),f.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[t])};p("readonly")?g.hide():(p("resetable")||g.hide(),p("wired")||(c.bind("touchmove touchend",t),c.mousemove(function(e){var t=w(this,e);b(t)}),c.mouseleave(function(){c.find(".rateit-hover").hide().width(0).data("width",""),f.trigger("hover",[null]).trigger("over",[null]),c.find(".rateit-selected").show()}),c.mouseup(function(e){var t=w(this,e),a=t*p("step")+p("min");x(a)}),c.keyup(function(e){(38==e.which||e.which==(r?39:37))&&x(Math.min(p("value")+p("step"),p("max"))),(40==e.which||e.which==(r?37:39))&&x(Math.max(p("value")-p("step"),p("min")))}),p("wired",!0)),p("resetable")&&g.show()),c.attr("aria-readonly",p("readonly"))})},e.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1}}(jQuery);